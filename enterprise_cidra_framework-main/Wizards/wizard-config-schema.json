{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CIDRA Configuration Schema",
  "description": "Schema for .cidra-config.json generated by setup wizard",
  "type": "object",
  "required": [
    "project_name",
    "technology",
    "plugin",
    "agents"
  ],
  "properties": {
    "project_name": {
      "type": "string",
      "description": "Name of the project being documented",
      "pattern": "^[A-Z0-9_]+$",
      "examples": ["FINANCE_SYSTEM", "HR_MODULE", "PAYROLL_APP"]
    },
    "technology": {
      "type": "string",
      "enum": ["SAP", "AS400", "React", "Python", "Custom"],
      "description": "Primary technology being documented"
    },
    "plugin": {
      "type": "string",
      "description": "Path to plugin file",
      "pattern": "^Plugins/.*\\.yaml$",
      "examples": ["Plugins/sap_plugin.yaml", "Plugins/as400_plugin.yaml"]
    },
    "code_location": {
      "type": "string",
      "description": "Path to source code directory"
    },
    "documentation_language": {
      "type": "string",
      "enum": ["he", "en"],
      "description": "Language for generated documentation",
      "default": "he"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of configuration creation"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of last update"
    },
    "agents": {
      "type": "object",
      "required": ["the_chunker", "the_documenter", "the_recommender"],
      "properties": {
        "the_chunker": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "strategy": {
              "type": "string",
              "enum": ["adaptive", "method-level", "program-level", "component-level"],
              "default": "adaptive"
            },
            "chunk_size": {
              "type": "string",
              "pattern": "^\\d+K?-\\d+K? tokens$",
              "default": "2K-4K tokens"
            },
            "optimization": {
              "type": "string",
              "enum": ["llm-friendly", "rag-optimized", "embedding-ready"],
              "default": "llm-friendly"
            }
          }
        },
        "the_documenter": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "anti_hallucination": {
              "type": "boolean",
              "default": true,
              "description": "Enable anti-hallucination framework"
            },
            "file_count": {
              "type": "integer",
              "minimum": 5,
              "maximum": 10,
              "default": 7,
              "description": "Number of documentation files to generate"
            },
            "citation_required": {
              "type": "boolean",
              "default": true,
              "description": "Require line number citations for code"
            },
            "exact_counting": {
              "type": "boolean",
              "default": true,
              "description": "Count code elements exactly (no approximations)"
            }
          }
        },
        "the_recommender": {
          "type": "object",
          "properties": {
            "enabled": {
              "type": "boolean",
              "default": true
            },
            "roi_analysis": {
              "type": "boolean",
              "default": true
            },
            "risk_assessment": {
              "type": "boolean",
              "default": true
            },
            "multi_criteria": {
              "type": "boolean",
              "default": true,
              "description": "Evaluate multiple criteria (cost, risk, effort, benefit)"
            }
          }
        }
      }
    },
    "validation": {
      "type": "object",
      "properties": {
        "strict_mode": {
          "type": "boolean",
          "default": false,
          "description": "Enable strict validation (fail on any warning)"
        },
        "min_quality_score": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "default": 100,
          "description": "Minimum required quality score (0-100)"
        },
        "required_sections": {
          "type": "string",
          "enum": ["all", "minimal", "custom"],
          "default": "all"
        },
        "code_verification": {
          "type": "boolean",
          "default": true,
          "description": "Verify all code citations exist in source"
        }
      }
    },
    "output": {
      "type": "object",
      "properties": {
        "directory": {
          "type": "string",
          "default": "./documentation",
          "description": "Output directory for generated documentation"
        },
        "format": {
          "type": "string",
          "enum": ["markdown", "html", "pdf"],
          "default": "markdown"
        },
        "include_validation_reports": {
          "type": "boolean",
          "default": true
        }
      }
    },
    "custom": {
      "type": "object",
      "description": "Custom settings specific to organization or project",
      "properties": {
        "naming_conventions": {
          "type": "object"
        },
        "business_rules": {
          "type": "array"
        },
        "quality_gates": {
          "type": "array"
        }
      }
    }
  }
}

